<!DOCTYPE HTML>
<html>
<head>
    <meta charset='utf-8'>
    <link rel='shortcut icon' type='image/png' href='jasmine_favicon.png'>
    <link rel='stylesheet' type='text/css'
     href='../node_modules/jasmine-core/lib/jasmine-core/jasmine.css'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <script type='text/javascript'
     src='../node_modules/jasmine-core/lib/jasmine-core/jasmine.js'></script>
    <script type='text/javascript'
     src='../node_modules/jasmine-core/lib/jasmine-core/jasmine-html.js'></script>
    <script type='text/javascript'
     src='../node_modules/jasmine-core/lib/jasmine-core/boot.js'></script>
    <script type='text/javascript' src='../jscrewit.js'></script>
    <script type='text/javascript' src='test_suite.js'></script>
    <script>
    
    function listener()
    {
        var bar = document.querySelector('.bar');
        if (bar)
        {
            removeEventListener('DOMNodeInserted', listener);
            var outputWindow;
            var button = bar.appendChild(document.createElement('BUTTON'));
            button.textContent = 'View lengths';
            button.onclick =
                function ()
                {
                    if (outputWindow) outputWindow.close();
                    var left = window.screenX + 50;
                    var top = window.screenY + 50;
                    var features =
                        'resizable,scrollbars,width=184,height=300,left=' + left + ',top=' + top;
                    outputWindow = window.open('', 'outputWindow', features);
                    // Chrome won't always bring the new popup to the front automatically, so we
                    // better take care of that.
                    outputWindow.focus();
                    var outputDocument = outputWindow.document;
                    outputDocument.title = 'JScrewIt Encoding Lengths';
                    var outputBody = outputDocument.body;
                    outputBody.textContent = TestSuite.createOutput(['DEFAULT', 'AUTO']);
                    var outputBodyStyle = outputBody.style;
                    outputBodyStyle.font = '12px "Courier New",Monaco,monospace';
                    outputBodyStyle.margin = '8px 20px';
                    outputBodyStyle.whiteSpace = 'pre';
                };
        }
    }

    TestSuite.init();
    TestSuite.run();
    
    addEventListener('DOMNodeInserted', listener);
    addEventListener(
        'load',
        function ()
        {
            var summary = document.querySelector('.symbol-summary');
            var info = summary.parentNode.insertBefore(document.createElement('DIV'), summary);
            info.style.padding = '6px 9px 0';
            info.textContent = 'Browser features: ' + JScrewIt.getSubFeatures('AUTO').join(', ');
        }
    );

    </script>
    <style>
    
    button
    {
        background-color: #aaa;
        border: #eee thin solid;
        box-shadow: 0 0 0 2px #aaa;
        color: #eee;
        font: 11px/16px Monaco, 'Lucida Console', monospace;
        margin: 7px 16px;
    }
    
    </style>
    <title>Jasmine Spec Runner</title>
</head>
<body>
</body>
</html>
